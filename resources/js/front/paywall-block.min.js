const comfinoSettings=wc.wcSettings.getSetting("comfino_data",{});
window.Comfino={label:wp.htmlEntities.decodeEntities(comfinoSettings.title)||wp.i18n.__("Comfino payments","comfino-payment-gateway"),isSelected:!1,isPaywallActive:!1,loanParams:{loanAmount:0,loanType:"",loanTerm:0},listItemContainer:null,labelObserver:null,Label:()=>{Comfino.isPaywallActive=!0;return comfinoSettings.icon?wp.element.RawHTML({children:Comfino.label+'<img id="comfino-gateway-logo" src="'+comfinoSettings.icon+'" alt="'+Comfino.label+'" style="margin-left: 10px; vertical-align: bottom">'}):
label},Content:b=>{const {eventRegistration:a,emitResponse:c}=b,{onPaymentSetup:d}=a;wp.element.useEffect(()=>{const e=d(async()=>({type:c.responseTypes.SUCCESS,meta:{paymentMethodData:{comfino_loan_amount:Comfino.loanParams.loanAmount.toString(),comfino_loan_type:Comfino.loanParams.loanType,comfino_loan_term:Comfino.loanParams.loanTerm.toString()}}}));return()=>{e()}},[c.responseTypes.SUCCESS,d]);return wp.element.RawHTML({children:wp.htmlEntities.decodeEntities(comfinoSettings.iframe)})},EditContent:()=>
wp.element.RawHTML({children:"<b>[Comfino Panel]</b>"}),init:()=>{if(Comfino.isPaywallActive)if("undefined"===typeof ComfinoPaywallFrontend)console.warn("ComfinoPaywallFrontend is undefined.");else if(!ComfinoPaywallFrontend.isInitialized()){comfinoSettings.paywallOptions.onUpdateOrderPaymentState=a=>{ComfinoPaywallFrontend.logEvent("updateOrderPaymentState WooCommerce (Payment Blocks)","debug",a);0!==a.loanTerm&&(Comfino.loanParams.loanAmount=a.loanAmount,Comfino.loanParams.loanType=a.loanType,Comfino.loanParams.loanTerm=
a.loanTerm)};var b=document.getElementById("comfino-paywall-container");if(null===b)if(b=document.getElementById("comfino-gateway-logo"),null===b)ComfinoPaywallFrontend.logEvent("Comfino logo not found in the payment block.","error");else{if(null===Comfino.listItemContainer){b=ComfinoPaywallFrontend.findMatchingParentElement(b,a=>null!==a.querySelector('input[type="radio"][value="comfino"]'));if(null===b){ComfinoPaywallFrontend.logEvent("Comfino initialization input element not found in the payment block.",
"error");return}Comfino.listItemContainer=ComfinoPaywallFrontend.findMatchingParentElement(b,a=>"DIV"===a.tagName)}null===Comfino.labelObserver&&(Comfino.labelObserver=new MutationObserver((a,c)=>{ComfinoPaywallFrontend.logEvent("Comfino item changed.","debug",a,c);Comfino.isSelected&&(a=document.getElementById("comfino-paywall-container"),ComfinoPaywallFrontend.logEvent("Deferred Comfino initialization started.","debug",a),ComfinoPaywallFrontend.init(null,a,comfinoSettings.paywallOptions),ComfinoPaywallFrontend.executeClickLogic())}),
Comfino.labelObserver.observe(Comfino.listItemContainer,{characterData:!0,subtree:!0,childList:!0}))}else ComfinoPaywallFrontend.init(null,b,comfinoSettings.paywallOptions)}}};wp.hooks.addAction("experimental__woocommerce_blocks-checkout-render-checkout-form","comfino",()=>{"comfino"===wp.data.select("wc/store/payment").getActivePaymentMethod()?Comfino.isSelected=!0:Comfino.isSelected=!1});
wp.hooks.addAction("experimental__woocommerce_blocks-checkout-set-active-payment-method","comfino",b=>{"comfino"===b.value?(Comfino.isSelected=!0,ComfinoPaywallFrontend.isInitialized()&&ComfinoPaywallFrontend.executeClickLogic()):Comfino.isSelected=!1});
wc.wcBlocksRegistry.registerPaymentMethod({name:"comfino",label:Object(wp.element.createElement)(Comfino.Label,null),icon:"money-alt",content:Object(wp.element.createElement)(Comfino.Content,null),edit:Object(wp.element.createElement)(Comfino.EditContent,null),canMakePayment:()=>{"complete"===document.readyState?(Comfino.init(),Comfino.isSelected&&ComfinoPaywallFrontend.executeClickLogic()):document.addEventListener("readystatechange",()=>{"complete"===document.readyState&&(Comfino.init(),Comfino.isSelected&&
ComfinoPaywallFrontend.executeClickLogic())});return!0},ariaLabel:Comfino.label,supports:{features:comfinoSettings.supports}});
